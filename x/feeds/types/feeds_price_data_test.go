package types_test

import (
	"encoding/hex"
	"testing"

	"github.com/stretchr/testify/require"

	"github.com/bandprotocol/chain/v2/x/feeds/types"
)

func TestABIEncodeFeedsPriceData(t *testing.T) {
	sp := types.SignalPrice{
		SignalID: "testSignal",
		Price:    100,
	}
	f := types.FeedsPriceData{
		SignalPrices: []types.SignalPrice{sp},
		Timestamp:    123456789,
	}

	expected := "000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000075bcd150000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000a746573745369676e616c00000000000000000000000000000000000000000000"
	result, err := f.ABIEncode()
	require.NoError(t, err)
	require.Equal(t, expected, hex.EncodeToString(result))
}
